# NICU Dashboard Environment Configuration
# Copy this file to .env.local and fill in the values
# NEVER commit .env.local or any file containing secrets to version control

# =============================================================================
# AUTHENTICATION (REQUIRED)
# =============================================================================

# NextAuth URL - Your application URL
NEXTAUTH_URL=http://localhost:3000

# NextAuth Secret - CRITICAL: Generate a secure random secret for production
# Generate with: openssl rand -base64 32
# NEVER use the default value in production!
NEXTAUTH_SECRET=CHANGE_ME_GENERATE_WITH_openssl_rand_base64_32

# Trust the host header (set to true for proxied deployments)
AUTH_TRUST_HOST=true

# =============================================================================
# DATABASE (REQUIRED)
# =============================================================================

# SQLite (Development)
DATABASE_URL="file:./dev.db"

# PostgreSQL (Production) - Uncomment and configure for production
# DATABASE_URL="postgresql://user:password@localhost:5432/nicu_dashboard?schema=public"

# =============================================================================
# DATABASE CONNECTION POOLING (PostgreSQL Production)
# =============================================================================
# These settings are automatically applied when using PostgreSQL.
# Adjust based on your database server capacity and application load.

# Maximum connections in the pool (default: 10)
# For serverless: start low (5-10), for traditional: based on DB max_connections
# DB_POOL_SIZE=10

# Connection timeout in milliseconds (default: 10000 = 10 seconds)
# DB_CONNECT_TIMEOUT=10000

# Idle connection timeout in milliseconds (default: 60000 = 60 seconds)
# DB_IDLE_TIMEOUT=60000

# Slow query threshold in milliseconds (default: 1000 = 1 second)
# Queries exceeding this will be logged as warnings
# DB_SLOW_QUERY_MS=1000

# Enable detailed query logging (default: false)
# WARNING: May expose sensitive data in logs - use only for debugging
# DB_QUERY_LOGGING=false

# =============================================================================
# SECURITY (REQUIRED FOR PRODUCTION)
# =============================================================================

# Allowed CORS origin - Set to your frontend domain in production
# NEVER use '*' in production!
ALLOWED_ORIGIN=http://localhost:3000

# Session timeout in seconds (default: 900 = 15 minutes of inactivity)
SESSION_INACTIVITY_TIMEOUT=900

# CSP Nonce Support (default: enabled)
# Generates a unique nonce per request for stricter Content Security Policy
# Disable only if experiencing compatibility issues with third-party scripts
# CSP_NONCE_ENABLED=true

# =============================================================================
# HTTPS ENFORCEMENT (AUTOMATIC IN PRODUCTION)
# =============================================================================
# HTTPS is automatically enforced when NODE_ENV=production
# The application will:
# - Redirect all HTTP requests to HTTPS (308 Permanent Redirect)
# - Set HSTS header (max-age=1 year, includeSubDomains, preload)
# - Apply security headers (X-Frame-Options, CSP, etc.)
#
# For production deployments behind a reverse proxy (nginx, AWS ALB, etc.):
# - Ensure the proxy sets X-Forwarded-Proto header
# - Configure SSL/TLS termination at the proxy level
# - Use TLS 1.2 or higher
#
# For local HTTPS testing (optional):
# NEXTAUTH_URL=https://localhost:3000

# =============================================================================
# REDIS (OPTIONAL - Required for distributed rate limiting in production)
# =============================================================================

# Redis connection URL (preferred for cloud deployments)
# REDIS_URL=redis://user:password@localhost:6379

# OR use individual parameters:
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=your_redis_password
# REDIS_DB=0

# Key prefix for Redis keys (default: nicu:)
# REDIS_KEY_PREFIX=nicu:

# Disable Redis (falls back to in-memory rate limiting)
# REDIS_DISABLED=true

# =============================================================================
# OPTIONAL SETTINGS
# =============================================================================

# Node environment
NODE_ENV=development

# Enable demo mode with simulated data (set to false in production)
DEMO_MODE=true

# Logging level (debug, info, warn, error)
LOG_LEVEL=info

# =============================================================================
# PRODUCTION CHECKLIST
# =============================================================================
# Before deploying to production, ensure:
#
# Authentication & Secrets:
# [ ] NEXTAUTH_SECRET is a cryptographically secure random value
# [ ] NEXTAUTH_URL uses https:// protocol
# [ ] All API keys and secrets are properly rotated
#
# Database:
# [ ] DATABASE_URL points to encrypted PostgreSQL with TimescaleDB
# [ ] All database connections use TLS
# [ ] DB_POOL_SIZE is tuned for your workload (default: 10)
# [ ] Database backups are configured and tested
# [ ] Connection pooling is working (check /api/health)
#
# Security:
# [ ] ALLOWED_ORIGIN is set to your specific domain (not '*')
# [ ] NODE_ENV is set to 'production'
# [ ] DEMO_MODE is set to 'false'
#
# HTTPS (Automatically enforced when NODE_ENV=production):
# [ ] SSL/TLS certificate is valid and not expired
# [ ] Reverse proxy sets X-Forwarded-Proto header
# [ ] TLS 1.2+ is enforced (disable TLS 1.0/1.1)
# [ ] Consider submitting to HSTS preload list: https://hstspreload.org
#
# Infrastructure:
# [ ] REDIS_URL is configured for distributed rate limiting
# [ ] Redis connection uses TLS in production
# [ ] Health check endpoint (/api/health) is monitored
# [ ] Error tracking service is configured (Sentry, etc.)
